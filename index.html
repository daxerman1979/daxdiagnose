<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DAX DIAGNOSE v10.5</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Roboto:wght@700;900&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        :root {
            --bg-color: #000000; --card-bg: #0c0c0c; --primary: #00d2ff;
            --safe: #00ff88; --danger: #ff1111; --text-main: #ffffff;
        }
        body, html { margin: 0; padding: 0; background-color: var(--bg-color); color: var(--text-main); font-family: 'Roboto', sans-serif; height: 100vh; width: 100vw; overflow: hidden; }

        header { 
            position: fixed; top: 0; width: 100%; height: 60px; background: #000; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            z-index: 100; border-bottom: 3px solid #1a1a1a; 
        }
        .header-title { font-family: 'Orbitron'; font-size: 14px; color: var(--primary); letter-spacing: 2px; font-weight: 800; }
        #connection-status { font-size: 10px; font-weight: 900; margin-top: 4px; text-transform: uppercase; }

        /* INTRO */
        #splash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5000; transition: transform 0.6s ease-in; }
        .btn-main { padding: 20px 40px; border-radius: 8px; background: var(--primary); color: #000; font-family: 'Orbitron'; border: none; font-weight: 800; cursor: pointer; font-size: 14px; margin: 10px; width: 80%; }

        /* DASHBOARD */
        .page { display: flex; position: absolute; top: 60px; bottom: 70px; width: 100%; padding: 10px; flex-direction: column; overflow-y: auto; }
        
        .card { background: var(--card-bg); border-radius: 12px; border: 2px solid #222; padding: 18px; margin-bottom: 12px; cursor: pointer; }
        .main-val { font-family: 'Orbitron'; font-size: 52px; text-align: center; margin: 5px 0; font-weight: 800; color: #fff; text-shadow: 0 0 10px rgba(0,210,255,0.3); }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card-label { font-size: 12px; color: #fff; font-weight: 900; text-transform: uppercase; margin-bottom: 8px; letter-spacing: 1px; }
        .card-val { font-family: 'Orbitron'; font-size: 28px; text-align: center; font-weight: 800; }
        
        .bar-bg { width: 100%; height: 8px; background: #1a1a1a; margin-top: 12px; border-radius: 4px; }
        .bar-fill { height: 100%; width: 0%; transition: width 0.5s; border-radius: 4px; }

        /* MODAL */
        #modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); display: none; z-index: 6000; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: #111; width: 100%; max-width: 450px; border: 2px solid var(--primary); padding: 25px; border-radius: 15px; }
        .m-title { color: var(--primary); font-family: 'Orbitron'; font-size: 20px; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .m-section { margin-bottom: 15px; }
        .m-subtitle { color: var(--safe); font-weight: 900; font-size: 14px; text-transform: uppercase; margin-bottom: 5px; }
        .m-text { color: #eee; font-size: 15px; line-height: 1.4; }

        nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: #000; display: flex; border-top: 3px solid #1a1a1a; }
        .nav-item { flex: 1; display: flex; align-items: center; justify-content: center; font-family: 'Orbitron'; font-size: 14px; font-weight: 800; color: #444; }
        .nav-item.active { color: var(--primary); }
    </style>
</head>
<body>

    <div id="splash">
        <h1 style="font-family:Orbitron; color:var(--primary); font-size:22px;">DAX DIAGNOSE PRO</h1>
        <button class="btn-main" onclick="requestBluetooth()">POVE≈ΩI ADAPTER</button>
        <button class="btn-main" style="background:#222; color:#888;" onclick="startMode('SIMULACIJA')">DEMO MOD</button>
    </div>

    <header>
        <div class="header-title">DAX DIAGNOSE PRO</div>
        <div id="connection-status">MOD: DISCONNECTED</div>
    </header>

    <div class="page">
        <div class="card" onclick="showInfo('NAPON AKUMULATORA')">
            <div class="card-label">‚ö° NAPON AKUMULATORA (V)</div>
            <div id="aku-val" class="main-val">--.- V</div>
            <div class="bar-bg"><div id="aku-bar" class="bar-fill"></div></div>
        </div>

        <div class="grid">
            <div class="card" onclick="showInfo('ZASIƒÜENOST DPF-A')">
                <div class="card-label">üí® DPF ƒåAƒê (%)</div>
                <div id="dpf-val" class="card-val">--%</div>
                <div class="bar-bg"><div id="dpf-bar" class="bar-fill"></div></div>
            </div>
            <div class="card" onclick="showInfo('TEMPERATURA MOTORA')">
                <div class="card-label">üå°Ô∏è VODA (¬∞C)</div>
                <div id="ant-val" class="card-val">--¬∞C</div>
                <div class="bar-bg"><div id="ant-bar" class="bar-fill"></div></div>
            </div>
            <div class="card" onclick="showInfo('OBRTAJI MOTORA')">
                <div class="card-label">‚öôÔ∏è RPM</div>
                <div id="rpm-val" class="card-val">----</div>
                <div class="bar-bg"><div id="rpm-bar" class="bar-fill"></div></div>
            </div>
            <div class="card" onclick="showInfo('BRZINA VOZILA')">
                <div class="card-label">üöÄ BRZINA</div>
                <div id="brz-val" class="card-val">--</div>
                <div class="bar-bg"><div id="brz-bar" class="bar-fill"></div></div>
            </div>
            <div class="card" onclick="showInfo('OPTEREƒÜENJE MOTORA')">
                <div class="card-label">üìä OPTEREƒÜENJE</div>
                <div id="load-val" class="card-val">--%</div>
                <div class="bar-bg"><div id="load-bar" class="bar-fill"></div></div>
            </div>
            <div class="card" onclick="showInfo('USIS VAZDUHA')">
                <div class="card-label">‚ùÑÔ∏è USIS (¬∞C)</div>
                <div id="iat-val" class="card-val">--¬∞C</div>
                <div class="bar-bg"><div id="iat-bar" class="bar-fill"></div></div>
            </div>
            <div class="card" onclick="showInfo('EGR SISTEM')">
                <div class="card-label">‚ôªÔ∏è EGR TEMP</div>
                <div id="egr-val" class="card-val">--¬∞C</div>
                <div class="bar-bg"><div id="egr-bar" class="bar-fill"></div></div>
            </div>
            <div class="card" onclick="showInfo('PRITISAK DPF-A')">
                <div class="card-label">‚è≤Ô∏è PSI (hPa)</div>
                <div id="pri-val" class="card-val">--</div>
                <div class="bar-bg"><div id="pri-bar" class="bar-fill"></div></div>
            </div>
        </div>
    </div>

    <div id="modal" onclick="this.style.display='none'">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h2 id="m-title" class="m-title"></h2>
            <div class="m-section">
                <div class="m-subtitle">Idealna vrednost:</div>
                <div id="m-ideal" class="m-text"></div>
            </div>
            <div class="m-section">
                <div class="m-subtitle">Kritiƒçna granica:</div>
                <div id="m-limit" class="m-text" style="color:var(--danger)"></div>
            </div>
            <div class="m-section">
                <div class="m-subtitle">Moguƒái kvarovi:</div>
                <div id="m-faults" class="m-text"></div>
            </div>
            <button class="btn-main" style="width:100%; margin:0;" onclick="document.getElementById('modal').style.display='none'">ZATVORI</button>
        </div>
    </div>

    <nav>
        <div class="nav-item active">DIJAGNOSTIKA</div>
        <div class="nav-item" onclick="alert('Opcija dostupna nakon povezivanja na ECU...')">GRE≈†KE</div>
    </nav>

    <script>
        const expertDb = {
            'NAPON AKUMULATORA': { ideal: '13.8V - 14.4V u radu', limit: 'Ispod 13.0V (ne puni) ili preko 15.0V (prepuno)', faults: 'Crkao alternator, regler ili lo≈°a masa na ≈°asiji.' },
            'ZASIƒÜENOST DPF-A': { ideal: 'Ispod 40% zasiƒáenosti', limit: 'Preko 80% (Safe mode / gubitak snage)', faults: 'Lo≈°e gorivo, zapu≈°en EGR, kratke relacije, problem sa senzorom pritiska.' },
            'TEMPERATURA MOTORA': { ideal: '90¬∞C fiksno', limit: 'Preko 105¬∞C (Opasnost od krivljenja glave)', faults: 'Termostat zaglavljen, vodena pumpa, curenje antifriza.' },
            'OBRTAJI MOTORA': { ideal: '800 RPM (ler), 2000-3000 (krstarenje)', limit: 'Preko 4500 RPM (Crvena zona)', faults: 'Senzor radilice, problem sa ubrizgavanjem dizni.' },
            'OPTEREƒÜENJE MOTORA': { ideal: '15-25% u leru', limit: 'Konstantno preko 90% bez ubrzanja', faults: 'Zapu≈°en usis, problem sa turbinom ili protokomerom (MAF).' },
            'PRITISAK DPF-A': { ideal: '0 - 15 hPa u leru', limit: 'Preko 50 hPa (DPF fiziƒçki zapu≈°en pepelom)', faults: 'DPF za zamenu ili profesionalno ƒçi≈°ƒáenje.' },
            'USIS VAZDUHA': { ideal: '10-30¬∞C iznad spoljne temperature', limit: 'Preko 70¬∞C (Gubitak performansi)', faults: 'Interkuler zaprljan ili probu≈°en.' },
            'EGR SISTEM': { ideal: 'Varira zavisno od gasa (150-400¬∞C)', limit: '0¬∞C (EGR blokiran/uga≈°en) ili preko 600¬∞C', faults: 'EGR ventil zaglavljen, hladnjak EGR-a zapu≈°en.' },
            'BRZINA VOZILA': { ideal: 'U skladu sa propisima', limit: 'Odstupanje od GPS brzine', faults: 'ABS senzor ili pogre≈°na dimenzija guma.' }
        };

        async function requestBluetooth() {
            try {
                const device = await navigator.bluetooth.requestDevice({
                    filters: [{ namePrefix: 'OBD' }, { namePrefix: 'V-LINK' }],
                    optionalServices: ['00001101-0000-1000-8000-00805f9b34fb']
                });
                startMode('LIVE: ' + device.name);
            } catch (e) { alert("Povezivanje otkazano."); }
        }

        function startMode(mode) {
            document.getElementById('connection-status').innerText = "MOD: " + mode;
            document.getElementById('connection-status').style.color = mode.includes('LIVE') ? "#00ff88" : "#ffcc00";
            document.getElementById('splash').style.transform = "translateY(-100%)";
            setInterval(updateData, 1000);
        }

        function updateData() {
            const keys = ['aku', 'dpf', 'ant', 'rpm', 'brz', 'load', 'iat', 'egr', 'pri'];
            keys.forEach(k => {
                let val = (Math.random() * 50).toFixed(1);
                if(k === 'aku') val = (Math.random() * 2 + 12.5).toFixed(1);
                if(k === 'rpm') val = Math.floor(Math.random() * 2000 + 800);
                
                const vEl = document.getElementById(k + '-val');
                const bEl = document.getElementById(k + '-bar');
                vEl.innerText = val + getUnit(k);
                bEl.style.width = Math.min(val / (k==='rpm'?50:1), 100) + "%";
                bEl.style.backgroundColor = (k==='aku' && val < 13.0) ? 'var(--danger)' : 'var(--safe)';
            });
        }

        function getUnit(k) {
            const units = { aku:' V', ant:'¬∞C', iat:'¬∞C', egr:'¬∞C', brz:' km/h', pri:' hPa', dpf:'%', load:'%', rpm:'' };
            return units[k];
        }

        function showInfo(title) {
            const db = expertDb[title];
            document.getElementById('m-title').innerText = title;
            document.getElementById('m-ideal').innerText = db.ideal;
            document.getElementById('m-limit').innerText = db.limit;
            document.getElementById('m-faults').innerText = db.faults;
            document.getElementById('modal').style.display = 'flex';
        }
    </script>
</body>
</html>
